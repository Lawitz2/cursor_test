# План реализации backend (MVP) — Облегченная версия для демо

Этот план нацелен на максимально быстрый запуск "Happy Path" (основного пути пользователя): Каталог -> Корзина -> Оформление -> Имитация оплаты.

---

## Этап 1: Инфраструктура и База данных (День 1-2)
- [x] Инициализация проекта, установка зависимостей (gin, sqlc, goose, pgx).
- [x] Настройка конфигурации (`.env`, `internal/config`).
- [ ] Подключение к PostgreSQL и применение существующих миграций.
- [ ] Генерация базового кода sqlc для таблиц `users`, `products`, `categories`.
- [x] Создание Health-check эндпоинта и базового роутера.

## Этап 2: Каталог товаров (День 3-4)
- [ ] **Backend:** Реализация репозиториев для категорий и товаров (List, GetBySlug).
- [ ] **API:** Эндпоинты `GET /api/v1/categories` и `GET /api/v1/products` (с базовой фильтрацией по категории).
- [ ] **Frontend (SSR):** Базовый шаблон (`base.tmpl`) с использованием простого CSS (например, Pico.css или Bootstrap для скорости).
- [ ] **Frontend (SSR):** Страница списка товаров и страница карточки товара.

## Этап 3: Корзина (День 5)
- [ ] **Backend:** Логика хранения корзины в БД (используем `guest_token` в Cookie).
- [ ] **API:** Добавление, удаление и изменение количества товаров в корзине.
- [ ] **Frontend (SSR):** Страница корзины с возможностью изменения состава заказа.

## Этап 4: Упрощенная Авторизация (Заглушка) (День 6)
- [ ] **Логика:** Вместо реальной отправки SMS, код подтверждения всегда `1234` (или выводится в лог сервера).
- [ ] **API:** Эндпоинты для запроса кода и верификации.
- [ ] **Auth:** Выдача JWT токена или установка Session Cookie после "проверки" кода.
- [ ] **Frontend:** Простая форма ввода телефона и кода.

## Этап 5: Оформление заказа (День 7)
- [ ] **Backend:** Создание записи в таблице `orders` и `order_items` на основе текущей корзины.
- [ ] **Валидация:** Минимальная проверка данных (телефон, адрес).
- [ ] **Frontend:** Страница оформления заказа (Checkout) с формой ввода данных доставки.

## Этап 6: Имитация оплаты (Заглушка) (День 8)
- [ ] **Логика:** Вместо интеграции с Т-Банком, создаем страницу-заглушку "Оплата".
- [ ] **Действие:** Кнопка "Подтвердить тестовую оплату", которая переводит статус заказа в `paid`.
- [ ] **Frontend:** Страница успешного завершения заказа ("Заказ №123 принят в работу").

## Этап 7: Личный кабинет и История заказов (День 9)
- [ ] **Backend:** Получение списка заказов текущего пользователя.
- [ ] **Frontend:** Простая страница профиля со списком прошлых заказов и их статусами.

## Этап 8: Мини-Админка и Полировка (День 10)
- [ ] **Админка:** Одна страница со списком всех заказов для демонстрации заказчику (просмотр статусов).
- [ ] **Поиск:** Простейший поиск по названию товара через `LIKE` (без FTS).
- [ ] **Финализация:** Обработка базовых ошибок (404, 500) и проверка всего пути пользователя.

---

## Что мы НЕ делаем в этой версии (отложено):
1. **Реальный Т-Банк:** Заменено кнопкой-заглушкой.
2. **Реальные SMS:** Заменено фиксированным кодом.
3. **Redis:** Для MVP используем Postgres или In-memory для хранения сессий/кодов.
4. **Загрузка медиа:** Картинки товаров прописываем ссылками в БД вручную.
5. **Сложный поиск:** Полнотекстовый поиск Postgres отложен.
6. **Полный CRUD в админке:** Добавление товаров пока через SQL/миграции.

## Технические решения для скорости:
- **CSS:** Использовать готовый легковесный фреймворк (Pico.css) для приличного вида без написания стилей.
- **JS:** Минимум JS, только для работы корзины (или вообще через обычные HTML-формы).
- **Auth:** Упрощенная сессия на Cookie.
